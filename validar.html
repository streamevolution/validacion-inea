<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Validación de Certificado INEA</title>
    <style>
        /* Fondo de la pantalla completa */
        body { font-family: 'Arial', sans-serif; background-color: #f3f4f6; margin: 0; padding: 20px; }
        
        /* Contenedor del Banner NUEVO (Afuera de la tarjeta) */
        .banner-exterior {
            max-width: 600px;
            margin: 0 auto 15px auto; /* Centrado y con separación de 15px hacia abajo */
            display: block;
        }
        .banner-exterior img {
            width: 100%;
            height: auto;
            display: block;
            border-radius: 8px; /* Pequeño borde redondeado opcional para que se vea mejor */
        }

        /* La Tarjeta Principal */
        .card { max-width: 600px; margin: 0 auto 20px auto; background: #EFEFEF; padding: 30px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        
        .header { text-align: center; border-bottom: 2px solid #4f46e5; padding-bottom: 15px; margin-bottom: 20px; }
        .header-logos {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .header-logos img {
            max-height: 60px;
            max-width: 45%;
            object-fit: contain;
        }

        h2 { color: #1e1b4b; margin: 0; text-transform: uppercase; font-size: 20px; }
        .item { margin-bottom: 15px; border-bottom: 1px solid #e5e7eb; padding-bottom: 8px; }
        .label { display: block; font-size: 12px; color: #6b7280; text-transform: uppercase; font-weight: bold; margin-bottom: 4px; }
        .value { display: block; font-size: 16px; color: #111827; font-weight: bold; }
        .status { text-align: center; margin-top: 30px; padding: 10px; background-color: #d1fae5; color: #047857; font-weight: bold; border-radius: 8px; font-size: 18px; text-transform: uppercase; }
        
        .footer {
            text-align: center;
            margin-top: 25px;
            padding-top: 15px;
            border-top: 1px solid #e5e7eb;
            font-size: 11px;
            line-height: 1.6;
            padding-left: 10px;
            padding-right: 10px;
        }
        .footer a {
            color: #6b7280;
            text-decoration: none;
            font-weight: bold;
            transition: color 0.3s ease;
            display: block;
        }
        .footer a:hover {
            color: #4f46e5;
            text-decoration: underline;
        }
    </style>

    <script>
        const params = new URLSearchParams(window.location.search);
        // Si no detecta la letra 'q' en el link, redirige inmediatamente
        if (!params.has('q') || !params.get('q')) {
            window.location.replace("https://www.gob.mx/inea/");
        }
    </script>
</head>
<body style="display: none;" id="cuerpoPagina">

    <div class="banner-exterior">
        <img src="https://i.postimg.cc/rwLF9LvX/banner-certificacion-sred-(1).png" alt="Banner Certificación SRED">
    </div>

    <div class="card" id="certificado-card">
        <div class="header">
            <div class="header-logos">
                <img src="https://i.postimg.cc/hGKvLmJD/1771716790494.png" alt="Logo Izquierdo">
                <img src="https://i.postimg.cc/52BjQg2L/1771716168716.png" alt="Logo Derecho">
            </div>
            <h2>Sistema de Validación de Certificados</h2>
        </div>
        
        <div class="item">
            <span class="label">Nombre del Alumno</span>
            <span class="value" id="val-nombre"></span>
        </div>
        <div class="item">
            <span class="label">CURP</span>
            <span class="value" id="val-curp"></span>
        </div>
        <div class="item">
            <span class="label">Institución</span>
            <span class="value" id="val-inst"></span>
        </div>
        <div class="item">
            <span class="label">Clave de Centro (CCT)</span>
            <span class="value" id="val-cct"></span>
        </div>
        <div class="item">
            <span class="label">Promedio Final</span>
            <span class="value" id="val-promn"></span>
        </div>
        <div class="item">
            <span class="label">Lugar de Emisión</span>
            <span class="value" id="val-ciudad"></span>
        </div>
        <div class="item">
            <span class="label">Fecha de Emisión</span>
            <span class="value" id="val-fecha"></span>
        </div>
        <div class="item" style="border: none;">
            <span class="label">Folio del Documento</span>
            <span class="value" style="color: #dc2626;" id="val-folio"></span>
        </div>

        <div class="status">
            ✓ Documento Válido ✓
        </div>

        <div class="footer">
            <a href="https://www.gob.mx/inea/" target="_blank" rel="noopener noreferrer">
                INSTITUTO NACIONAL PARA LA EDUCACIÓN DE LOS ADULTOS, MÉXICO<br>
                ALGUNOS DERECHOS RESERVADOS © 2026
            </a>
        </div>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const params = new URLSearchParams(window.location.search);
            const q = params.get('q');

            try {
                // AQUÍ ESTÁ LA MAGIA: JSON.parse es extremadamente estricto. 
                const partes = JSON.parse(decodeURIComponent(escape(atob(q))));

                // Validamos que la información esté completa
                if (!Array.isArray(partes) || partes.length < 8) {
                    throw new Error("Código incompleto");
                }

                // Asignamos los valores si todo fue perfecto
                document.getElementById('val-nombre').textContent = (partes[0] || '').toUpperCase();
                document.getElementById('val-curp').textContent = (partes[1] || '').toUpperCase();
                document.getElementById('val-inst').textContent = partes[2] || '';
                document.getElementById('val-cct').textContent = partes[3] || '';
                document.getElementById('val-promn').textContent = partes[4] || '';
                document.getElementById('val-ciudad').textContent = (partes[5] || '').toUpperCase();
                
                let fechaRaw = partes[6] || '';
                document.getElementById('val-folio').textContent = partes[7] || '';

                // --- TRADUCTOR INTELIGENTE DE FECHAS ---
                let fechaFormateada = fechaRaw.toUpperCase();
                let fechaLimpia = fechaFormateada.replace(/Á/g, 'A').replace(/É/g, 'E').replace(/Í/g, 'I').replace(/Ó/g, 'O').replace(/Ú/g, 'U').replace(/\s+/g, '');

                const diasMap = {
                    'TREINTAYUNO': '31', 'TREINTA': '30', 'VEINTINUEVE': '29', 'VEINTIOCHO': '28', 'VEINTISIETE': '27',
                    'VEINTISEIS': '26', 'VEINTICINCO': '25', 'VEINTICUATRO': '24', 'VEINTITRES': '23', 'VEINTIDOS': '22',
                    'VEINTIUNO': '21', 'VEINTE': '20', 'DIECINUEVE': '19', 'DIECIOCHO': '18', 'DIECISIETE': '17',
                    'DIECISEIS': '16', 'QUINCE': '15', 'CATORCE': '14', 'TRECE': '13', 'DOCE': '12', 'ONCE': '11',
                    'DIEZ': '10', 'NUEVE': '09', 'OCHO': '08', 'SIETE': '07', 'SEIS': '06', 'CINCO': '05',
                    'CUATRO': '04', 'TRES': '03', 'DOS': '02', 'UN': '01', 'UNO': '01'
                };

                const mesesMap = {
                    'ENERO': '01', 'FEBRERO': '02', 'MARZO': '03', 'ABRIL': '04',
                    'MAYO': '05', 'JUNIO': '06', 'JULIO': '07', 'AGOSTO': '08',
                    'SEPTIEMBRE': '09', 'OCTUBRE': '10', 'NOVIEMBRE': '11', 'DICIEMBRE': '12'
                };

                const aniosMap = {
                    'DOSMILTREINTA': '2030', 'DOSMILVEINTINUEVE': '2029', 'DOSMILVEINTIOCHO': '2028',
                    'DOSMILVEINTISIETE': '2027', 'DOSMILVEINTISEIS': '2026', 'DOSMILVEINTICINCO': '2025',
                    'DOSMILVEINTICUATRO': '2024', 'DOSMILVEINTITRES': '2023', 'DOSMILVEINTIDOS': '2022',
                    'DOSMILVEINTIUNO': '2021', 'DOSMILVEINTE': '2020', 'DOSMILDIECINUEVE': '2019',
                    'DOSMILDIECIOCHO': '2018', 'DOSMILDIECISIETE': '2017', 'DOSMILDIECISEIS': '2016'
                };

                if (fechaLimpia.includes('ALOS') || fechaLimpia.includes('DIAS') || fechaLimpia.includes('DELMES') || fechaLimpia.includes('DOSMIL')) {
                    let diaNum = 'XX';
                    let mesNum = 'XX';
                    let anioNum = 'XXXX';

                    for (let palabra in diasMap) {
                        if (fechaLimpia.includes('LOS' + palabra) || fechaLimpia.includes(palabra + 'DIAS')) {
                            diaNum = diasMap[palabra];
                            break;
                        }
                    }
                    if (diaNum === 'XX') { 
                        for (let palabra in diasMap) {
                            if (fechaLimpia.includes(palabra)) { diaNum = diasMap[palabra]; break; }
                        }
                    }

                    if (diaNum.startsWith('0') && diaNum !== 'XX') {
                        diaNum = diaNum.substring(1);
                    }

                    for (let palabra in mesesMap) {
                        if (fechaLimpia.includes(palabra)) {
                            mesNum = mesesMap[palabra];
                            break;
                        }
                    }

                    for (let palabra in aniosMap) {
                        if (fechaLimpia.includes(palabra)) {
                            anioNum = aniosMap[palabra];
                            break;
                        }
                    }
                    
                    let numerosEnTexto = fechaLimpia.match(/\d{4}/);
                    if(numerosEnTexto && anioNum === 'XXXX') {
                        anioNum = numerosEnTexto[0];
                    }

                    fechaFormateada = `${diaNum} DE ${mesNum} DE ${anioNum}`;
                } 
                
                document.getElementById('val-fecha').textContent = fechaFormateada;

                // 4. Si el código no fue alterado, mostramos la pantalla
                document.getElementById('cuerpoPagina').style.display = "block";

            } catch (error) {
                window.location.replace("https://www.gob.mx/inea/");
            }
        });
    </script>
</body>
</html>
