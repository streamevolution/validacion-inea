<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Certificado de Terminación de Estudios</title>
    
    <link href="https://framework-gb.cdn.gob.mx/assets/styles/main.css" rel="stylesheet">
    
    <style>
        body { background-color: #ffffff; }
        .table-responsive { margin-top: 20px; border: none; }
        .table>tbody>tr>th { background-color: #f9f9f9; width: 35%; font-weight: 600; vertical-align: middle; }
        .table>tbody>tr>td { vertical-align: middle; }
        .section-title { background-color: #F2F2F2 !important; font-weight: bold; text-align: left; padding: 12px 10px !important; font-size: 16px; border-bottom: 2px solid #ddd; }
        .alert-success { background-color: #dff0d8; border-color: #d6e9c6; color: #3c763d; padding: 15px; margin-top: 20px; border-radius: 4px; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
        .page { padding-top: 40px; padding-bottom: 60px; min-height: calc(100vh - 200px); }
        hr.red { border-top: 2px solid #D0021B; width: 100%; margin-top: 0; }
    </style>

    <script>
        const params = new URLSearchParams(window.location.search);
        // Si no detecta el código cifrado 'q', redirige inmediatamente
        if (!params.has('q')) {
            window.location.replace("https://www.gob.mx/sep");
        }
    </script>
</head>
<body id="cuerpoPagina" style="display: none;">

    <nav class="navbar navbar-inverse sub-navbar navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#subenlaces">
                    <span class="sr-only">Interruptor de Navegación</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="https://www.gob.mx/">
                    <img src="https://framework-gb.cdn.gob.mx/landing/img/logoheader.svg" width="128" height="37" alt="Página de inicio, Gobierno de México">
                </a>
            </div>
            <div class="collapse navbar-collapse" id="subenlaces">
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="https://www.gob.mx/tramites">Trámites</a></li>
                    <li><a href="https://www.gob.mx/gobierno">Gobierno</a></li>
                    <li><a href="https://www.gob.mx/busqueda"><span class="sr-only">Búsqueda</span><i class="icon-search"></i></a></li>
                </ul>
            </div>
        </div>
    </nav>

    <main class="page">
        <div class="container">
            <div class="row">
                <div class="col-sm-12">
                    <ol class="breadcrumb">
                        <li><a href="https://www.gob.mx/"><i class="icon-home"></i></a></li>
                        <li><a href="https://www.gob.mx/sep">SEP</a></li>
                        <li class="active">Validación de Certificado</li>
                    </ol>
                    <h2>Certificado de Terminación de Estudios</h2>
                    <hr class="red">
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-12">
                    <div class="table-responsive">
                        <table class="table table-bordered">
                            <tbody>
                                <tr>
                                    <td colspan="2" class="section-title">Datos del estudiante</td>
                                </tr>
                                <tr>
                                    <th>Nombre y apellidos:</th>
                                    <td id="valNombre">-</td>
                                </tr>
                                <tr>
                                    <th>Matrícula:</th>
                                    <td id="valMatricula">-</td>
                                </tr>

                                <tr>
                                    <td colspan="2" class="section-title">Datos del plantel o servicio educativo</td>
                                </tr>
                                <tr>
                                    <th>Institución educativa emisora:</th>
                                    <td>Servicio Nacional de Bachillerato en Línea, "Prepa en Línea-SEP"</td>
                                </tr>
                                <tr>
                                    <th>Plantel o servicio educativo:</th>
                                    <td>Servicio Nacional de Bachillerato en Línea, "Prepa en Línea-SEP"</td>
                                </tr>
                                <tr>
                                    <th>Clave de Centro de Trabajo:</th>
                                    <td>09DBH0001D</td>
                                </tr>

                                <tr>
                                    <td colspan="2" class="section-title">Trayectoria académica y datos del documento</td>
                                </tr>
                                <tr>
                                    <th>Plan de estudios:</th>
                                    <td>Bachillerato, con formación básica para el trabajo en <span id="valFormacion" style="text-transform: lowercase;"></span></td>
                                </tr>
                                <tr>
                                    <th>Promedio:</th>
                                    <td><span id="valPromn">-</span> <span id="valProml" style="text-transform: uppercase;">-</span></td>
                                </tr>
                                <tr>
                                    <th>Créditos obtenidos:</th>
                                    <td>276 de un total de 276</td>
                                </tr>
                                <tr>
                                    <th>Periodo de estudios:</th>
                                    <td id="valFecha">-</td>
                                </tr>
                                <tr>
                                    <th>Tipo de documento:</th>
                                    <td>Certificado de Terminación de Estudios</td>
                                </tr>
                                <tr>
                                    <th>Estatus:</th>
                                    <td>Registrado en el SIGED</td>
                                </tr>
                                <tr>
                                    <th>Folio:</th>
                                    <td id="valFolio">-</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="alert alert-success">
                        <h4 style="margin: 0; font-weight: bold;">Documento Validado.</h4>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script src="https://framework-gb.cdn.gob.mx/gobmx.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const params = new URLSearchParams(window.location.search);
            const q = params.get('q');
            
            try {
                // 1. Decodificar
                const datosDecodificados = decodeURIComponent(escape(atob(q)));
                
                // 2. Separar los datos usando la rayita vertical "|"
                const partes = datosDecodificados.split('|');
                
                // Si no tiene 8 partes, alguien intentó alterar el código
                if (partes.length !== 8) throw new Error("Código alterado");

                // 3. Asignar los valores a la página clonada
                document.getElementById('valNombre').textContent = partes[0] || '-';
                document.getElementById('valMatricula').textContent = partes[2] || '-'; // La matrícula es la parte 2
                document.getElementById('valFormacion').textContent = partes[3] || '-';
                document.getElementById('valPromn').textContent = partes[4] || '-';
                document.getElementById('valProml').textContent = partes[5] || '-';
                
                // Le volvemos a pegar el prefijo al folio
                document.getElementById('valFolio').textContent = '6e2ecb41-886d-4966-b6b5-' + partes[6];
                
                // Asignamos la fecha
                document.getElementById('valFecha').textContent = partes[7] || '-';

                // Mostrar la página solo si la seguridad pasó al 100%
                document.getElementById('cuerpoPagina').style.display = "block";

            } catch (error) {
                // Redirección en milisegundos si hay anomalías
                window.location.replace("https://www.gob.mx/sep");
            }
        });
    </script>
</body>
</html>
